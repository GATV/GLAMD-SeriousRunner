using UnityEngine;
using System.Collections;
using Assets.Scripts;
using System.Collections.Generic;

public class ReplayGhostController : MonoBehaviour
{

    private Replay r;
    private Direction lastDirection;
    private Queue<Direction> directionQueue;
    private Animator animator;

    // Use this for initialization
    void Start()
    {
        animator = GetComponent<Animator>();
        r = new Replay("0,0.0,-0.5,-8.7,0_1,0.0,-0.5,-7.4,0_2,0.0,-0.5,-6.2,0_3,0.0,-0.5,-5.0,0_4,0.0,-0.5,-3.8,0_5,0.0,-0.5,-2.6,0_6,0.0,-0.5,-1.4,0_7,0.0,-0.5,-0.2,0_8,0.0,-0.4,1.0,0_9,0.0,-0.4,2.2,0_10,0.0,-0.4,3.4,0_11,0.0,-0.4,4.6,0_12,0.0,-0.4,5.8,0_13,0.0,-0.4,6.9,0_14,0.0,-0.4,8.1,0_15,0.0,-0.4,9.4,0_16,0.0,-0.4,10.6,0_17,0.0,-0.4,11.7,0_18,0.0,-0.4,13.0,0_19,0.0,-0.4,14.2,0_20,0.0,-0.4,15.3,0_21,0.0,-0.4,16.6,0_22,0.0,-0.4,17.8,0_23,0.0,-0.4,18.9,0_24,0.0,0.7,20.2,0_25,0.0,1.3,21.4,0_26,0.0,1.2,22.5,0_27,0.0,0.4,23.7,0_28,0.0,-0.4,25.0,0_29,-1.1,-0.4,26.2,0_30,-2.0,-0.4,27.4,0_31,-2.0,-0.4,28.6,0_32,-2.0,-0.4,29.8,0_33,-2.0,-0.4,30.9,0_34,-2.0,-0.4,32.2,0_35,-1.3,-0.4,33.3,0_36,0.0,-0.4,34.6,0_37,0.0,-0.4,35.7,0_38,0.4,-0.4,37.0,0_39,1.7,-0.4,38.2,0_40,2.0,-0.4,39.4,0_41,2.0,-0.4,40.5,0_42,1.6,-0.4,41.7,0_43,0.4,-0.4,42.9,0_44,0.0,-0.4,44.2,0_45,0.0,-0.4,45.4,0_46,0.0,-0.4,46.6,0_47,0.0,-0.4,47.8,0_48,1.2,-0.4,49.0,0_49,2.0,-0.4,50.2,0_50,2.0,-0.4,51.4,0_51,2.0,-0.4,52.6,0_52,2.0,-0.4,53.8,0_53,2.2,-0.4,55.0,1_54,3.3,-0.4,55.0,1_55,4.6,-0.4,55.0,1_56,5.8,-0.4,55.0,1_57,7.0,0.4,55.0,1_58,8.3,1.2,55.0,1_59,9.5,1.2,55.0,1_60,10.6,0.5,55.0,1_61,11.8,-0.4,55.0,1_62,13.0,-0.4,55.4,1_63,14.2,-0.4,56.6,1_64,15.4,-0.4,57.0,1_65,16.6,-0.4,56.8,1_66,17.8,-0.4,55.6,1_67,19.0,-0.3,55.0,1_68,20.2,0.7,55.0,1_69,21.4,1.3,55.0,1_70,22.6,1.1,55.0,1_71,23.8,0.3,55.0,1_72,25.0,-0.4,55.0,1_73,26.2,-0.4,55.0,1_74,27.5,-0.4,55.6,1_75,28.6,-0.4,56.8,1_76,29.8,-0.4,57.0,1_77,31.0,-0.4,57.0,1_78,32.2,-0.4,57.0,1_79,33.4,-0.4,57.0,1_80,34.6,-0.4,57.0,1_81,35.8,-0.4,57.0,1_82,37.0,-0.4,57.0,1_83,38.2,-0.4,57.0,1_84,39.4,-0.4,57.0,1_85,40.6,-0.4,57.0,1_86,41.8,-0.4,57.0,1_87,43.2,-0.4,57.0,1_88,45.3,0.3,57.0,1_89,47.3,1.2,57.0,1_90,49.3,1.3,57.0,1_91,51.3,0.7,57.0,1_92,53.3,-0.4,57.0,1_93,55.2,-0.4,57.3,1_94,57.2,-0.4,59.0,1_95,59.2,-0.4,59.0,1_96,61.2,-0.4,59.0,1_97,63.2,-0.4,59.0,1_98,65.2,-0.4,59.0,1_99,66.0,-0.4,60.8,0_100,66.0,-0.4,62.9,0_101,66.0,-0.4,64.9,0_102,66.0,-0.3,66.9,0_103,66.0,0.8,68.9,0_104,66.0,1.3,70.9,0_105,66.0,1.1,72.8,0_106,66.0,0.3,74.8,0_107,66.0,-0.4,76.7,0_108,66.0,-0.4,77.9,0_109,66.0,-0.4,79.1,0_110,66.0,-0.4,80.3,0_111,66.0,-0.4,81.4,0_112,66.0,-0.4,82.7,0_113,66.0,-0.4,83.9,0_114,66.0,-0.4,85.1,0_115,66.0,-0.4,86.2,0_116,66.0,-0.4,87.5,0_117,66.0,-0.4,88.7,0_118,66.0,-0.4,89.9,0_119,66.0,-0.4,91.1,0_120,66.0,-0.4,92.3,0_121,66.0,-0.4,93.4,0_122,66.0,-0.4,94.6,0_123,66.0,-0.4,95.9,0_124,66.0,0.7,97.7,0_125,66.0,1.3,99.6,0_126,66.0,1.2,101.6,0_127,66.0,0.3,103.6,0_128,66.0,-0.4,105.7,0_129,66.0,-0.4,107.7,0_130,64.5,-0.4,109.8,0_131,64.0,-0.4,111.7,0_132,64.0,-0.4,113.7,0_133,64.0,-0.4,115.7,0_134,64.0,-0.4,117.7,0_135,64.0,-0.4,119.7,0_136,64.0,-0.4,121.7,0_137,63.7,-0.4,123.7,0_138,62.0,-0.4,125.7,0_139,62.0,-0.4,127.6,0_140,62.0,-0.4,129.6,0_141,63.5,-0.4,131.6,0_142,65.5,-0.4,133.6,0_143,66.0,-0.4,135.8,0_144,66.0,-0.4,137.2,0_145,65.3,-0.4,138.4,0_146,64.1,-0.4,139.5,0_147,64.0,0.4,140.7,0_148,64.0,1.2,141.9,0_149,64.0,1.3,143.1,0_150,64.0,0.6,144.3,0_151,64.0,-0.4,145.5,0_152,64.0,-0.4,146.7,0_153,64.0,-0.4,147.9,0_154,64.0,-0.4,149.1,0_155,64.0,-0.4,150.3,0_156,64.0,-0.4,151.5,0_157,64.0,-0.4,152.8,0_158,64.7,-0.4,154.0,0_159,65.9,-0.4,155.2,0_160,66.0,-0.4,156.3,0_161,66.0,-0.4,157.5,0_162,66.0,-0.4,158.7,0_163,66.0,-0.4,159.9,0_164,66.0,-0.4,161.1,0_165,66.0,-0.4,162.3,0_166,66.0,-0.4,163.5,0_167,66.0,-0.4,164.7,0_168,66.0,-0.4,165.9,0_169,66.0,-0.4,167.1,0_170,66.0,-0.4,168.3,0_171,66.0,-0.4,169.6,0_172,66.0,-0.4,170.8,0_173,66.0,-0.4,171.9,0_174,66.0,-0.4,173.1,0_175,66.0,-0.4,174.3,0_176,66.0,-0.4,175.5,0_177,65.4,-0.4,176.7,0_178,64.2,-0.4,177.9,0_179,63.0,-0.4,179.1,0_180,62.0,-0.4,180.3,0_181,62.0,-0.4,181.5,0_182,62.0,-0.4,182.7,0_183,62.0,-0.4,183.9,0_184,63.1,-0.4,185.2,0_185,64.3,-0.4,186.4,0_186,65.5,-0.4,187.6,0_187,66.7,-0.4,187.0,1_188,67.9,-0.4,187.0,1_189,69.1,-0.4,187.0,1_190,70.3,-0.4,187.4,1_191,71.4,-0.4,188.6,1_192,72.6,-0.4,189.0,1_193,73.8,0.1,189.0,1_194,75.0,1.0,189.0,1_195,76.2,1.3,189.0,1_196,77.4,0.9,189.0,1_197,78.6,-0.1,189.0,1_198,79.9,-0.4,189.0,1_199,81.1,-0.4,189.0,1_200,82.3,-0.4,189.0,1_201,83.5,-0.4,188.6,1_202,84.7,-0.4,187.4,1_203,85.9,-0.2,187.0,1_204,87.0,0.8,187.0,1_205,88.2,1.3,187.0,1_206,89.4,1.1,187.0,1_207,90.6,0.2,187.0,1_208,91.8,-0.4,187.0,1_209,93.0,-0.4,188.1,1_210,94.2,-0.4,189.3,1_211,95.4,-0.4,190.5,1_212,96.6,0.6,191.0,1_213,97.9,1.3,191.0,1_214,99.1,1.2,191.0,1_215,100.3,0.4,191.0,1_216,101.5,-0.4,191.0,1_217,102.7,-0.4,191.0,1_218,103.9,-0.4,189.8,1_219,105.1,-0.4,189.0,1_220,105.6,-0.4,189.0,1_221,105.8,-0.4,189.2,1_222,106.1,-0.4,189.5,1_223,106.5,-0.4,189.8,1_224,106.7,-0.4,190.0,1_225,106.9,-0.4,190.3,1_226,107.2,-0.4,190.6,1_227,107.6,-0.4,190.9,1_228,108.6,-0.4,191.0,1_229,109.8,-0.4,191.0,1_230,111.0,0.5,191.0,1_231,112.2,1.2,191.0,1_232,113.4,1.2,191.0,1_233,114.6,0.5,191.0,1_234,115.2,-0.4,191.0,1_235,115.4,-0.4,191.0,1_236,115.7,-0.4,191.0,1_237,116.0,-0.4,191.0,1_238,116.4,-0.4,191.0,1_239,116.8,-0.4,191.0,1_240,117.3,-0.4,191.0,1_241,117.8,-0.4,191.0,1_242,118.3,-0.4,191.0,1_243,118.9,0.5,191.0,1_244,119.5,1.2,191.0,1_245,120.1,1.2,191.0,1_246,120.8,0.5,191.0,1_247,121.2,-0.4,191.0,1_248,121.4,-0.4,191.0,1_249,121.7,-0.4,190.9,1_250,122.1,-0.4,190.5,1_251,122.4,-0.4,190.2,1_252,122.8,-0.4,189.8,1_253,123.3,-0.4,189.3,1_254,123.8,-0.4,189.0,1_255,124.3,-0.4,189.0,1_256,124.9,-0.4,189.0,1_257,125.5,-0.4,189.0,1_258,126.1,-0.4,189.0,1_259,126.8,0.0,189.0,1_260,127.5,1.0,189.0,1_261,128.3,1.3,189.0,1_262,129.1,1.0,189.0,1_263,130.0,0.0,189.0,1_264,130.8,-0.4,189.0,1_265,131.8,-0.4,189.0,1_266,132.7,-0.4,189.0,1_267,133.7,-0.4,189.0,1_268,134.8,-0.4,188.0,1_269,135.5,0.5,187.2,1_270,135.7,1.2,187.0,1_271,136.0,1.2,187.0,1_272,136.3,0.5,187.0,1_273,136.7,-0.4,187.0,1_274,137.1,-0.4,187.0,1_275,137.5,-0.4,187.5,1_276,138.0,-0.4,188.0,1_277,138.5,-0.4,188.5,1_278,139.1,-0.4,189.0,1_279,139.7,-0.4,189.0,1_280,140.3,-0.4,189.0,1_281,141.0,-0.4,189.0,1_282,141.8,-0.4,189.0,1_283,142.5,-0.4,189.0,1_284,143.3,-0.4,189.0,1_285,144.1,-0.4,189.0,1");
        directionQueue = r.GetDirectionQueue();
        lastDirection = directionQueue.Dequeue();
        InvokeRepeating("UpdateOrientation", 0, 0.2f);
        animator.SetFloat("Speed", 10);
        iTween.MoveTo(gameObject, iTween.Hash("path", r.Path, "time", r.Count * 0.2f, "easetype", iTween.EaseType.linear));
    }

    void UpdateOrientation()
    {
        if (directionQueue.Count > 0)
        {
            Direction newDirection = directionQueue.Dequeue();
            if (lastDirection != newDirection)
            {
                iTween.RotateTo(gameObject, new Vector3(0, (int)newDirection * 90, 0), 1);
                lastDirection = newDirection;
            }
        }
        else
        {
            CancelInvoke("UpdateOrientation");
            animator.SetFloat("Speed", 0);
            animator.Play("Wary");
        }
    }
}
