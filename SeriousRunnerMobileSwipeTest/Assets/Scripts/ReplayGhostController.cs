using UnityEngine;
using System.Collections;
using Assets.Scripts;
using System.Collections.Generic;

public class ReplayGhostController : MonoBehaviour {

    private Replay r;
    private Direction lastDirection;
    private Queue<Direction> directionQueue;
    private Animator animator;

    // Use this for initialization
    void Start()
    {
        animator = GetComponent<Animator>();
        r = new Replay(""); // Fill with Ghost Data
        directionQueue = r.GetDirectionQueue();
        lastDirection = directionQueue.Dequeue();
        InvokeRepeating("UpdateOrientation", 0, 0.2f);        
        animator.SetFloat("Speed", 10);
        iTween.MoveTo(gameObject, iTween.Hash("path", r.Path, "time", r.Count * 0.2f, "easetype", iTween.EaseType.linear));
    }

    void UpdateOrientation()
    {
        if (directionQueue.Count > 0)
        {
            Direction newDirection = directionQueue.Dequeue();
            if (lastDirection != newDirection)
            {
                iTween.RotateTo(gameObject, new Vector3(0, (int)newDirection * 90, 0), 1);
                lastDirection = newDirection;
            }            
        }
        else
        {
            CancelInvoke("UpdateOrientation");
            animator.SetFloat("Speed", 0);
            animator.Play("Wary");
        }
    }

    // Example Ghost Path
    // 0,0,0,-10.02,0_1,0,0.08000004,-8.432499,0_2,0,0.0800001,-5.799064,0_3,0,0.08000004,-3.810124,0_4,0,0.08000004,-1.657397,0_5,0,0.1,0.3332076,0_6,0,0.1,2.318597,0_7,0,0.1,4.307312,0_8,0,0.1,6.294593,0_9,1.988001,0.1,8.282594,0_10,2,0.1000001,10.2706,0_11,2,0.1,12.25097,0_12,2,0.09999996,14.23794,0_13,2,0.1,16.2258,0_14,2,0.1,18.21379,0_15,2,0.1,20.20179,0_16,2,0.3110068,22.18979,0_17,2,1.480459,24.34563,0_18,2,1.987128,26.33147,0_19,2,1.74448,28.31946,0_20,2,0.8426694,30.30841,0_21,3.271278,0.1,31,1_22,5.356009,0.1,31,1_23,7.21494,0.1,31,1_24,9.34616,0.1,31,1_25,11.21449,0.1,31,1_26,13.33182,0.1,31,1_27,15.28784,0.1,31,1_28,17.29301,0.1,31,1_29,19.26399,0.1000001,31,1_30,21.22666,0.1,31,1_31,23.23866,0.1,31,1_32,25.35025,0.1,31,1_33,27.2175,0.1000001,31,1_34,28,0.1,31.77435,0_35,28,0.1,33.71515,0_36,28,0.1,35.84213,0_37,28,0.1,37.82987,0_38,28,0.1,39.72218,0_39,28,0.1,41.78118,0_40,28,0.1,43.76917,0_41,28,0.1,45.75717,0_42,28,0.1,47.74518,0_43,28,0.1000001,49.80076,0_44,28,0.1,51.86366,0_45,28,0.1,53.7552,0_46,28,0.2495659,55.78598,0_47,28,1.362778,57.77399,0_48,28,1.970027,59.83598,0_49,28,1.799897,61.82379,0_50,28,0.9502419,63.81179,0_51,28,0.1,65.79978,0_52,28,0.1,67.78779,0_53,28,0.1,69.84081,0_54,28,0.1,71.82881,0_55,28,0.1,73.7158,0_56,26.2804,0.1,75,3_57,24.2511,0.1,75,3_58,22.23233,0.1,75,3_59,20.2067,0.1,75,3_60,18.23356,0.1,75,3_61,16.2114,0.1,75,3_62,13.47992,1.150554,75,3_63,10.73151,1.884766,75,3_64,7.801145,1.900686,75,3_65,5.041382,1.186431,75,3_66,2.312541,0.1,75,3_67,2,0.1,77.23513,0_68,2,0.1,79.96072,0_69,2,0.09999994,82.61894,0_70,2,0.1,85.59972,0_71,2,0.1,88.24836,0_72,2,0.09999998,91.21825,0_73,2,0.1,93.98034,0_74,2,0.1,96.71565,0_75,2,0.1,99.49886,0_76,2,0.1000001,102.2471,0_77,2,0.1,105.2113,0_78,2,0.1,107.9632,0_79,2,0.1,110.7001,0_80,2,0.1,113.5375,0_81,4.103472,0.1,115,1_82,6.038234,0.1,115,1_83,8.061843,0.1,115,1_84,10.08711,0.1,115,1_85,11.95242,0.1000001,115,1_86,13.97003,0.09999996,115,1_87,16.10283,0.1,115,1_88,17.97003,0.1,115,1_89,20.1005,0.1,115,1_90,21.95427,0.1000001,115,1_91,23.9747,0.1,115,1_92,25.95763,0.1,115,1_93,27.97422,0.1,115,1_94,29.99198,0.1,115,1_95,31.96482,0.1,115,1_96,33.96946,0.1000001,115,1_97,36.09725,0.1,115,1_98,37.96129,0.1,115,1_99,39.96409,0.08000004,115,1_100,42.05117,0.08000004,115,1_101,42,0.08000004,116.0421,0_102,42,0.08000004,118.1364,0_103,42,0.0996182,119.9834,0_104,42,0.1,122.1227,0_105,42,0.1,124.085,0_106,42,0.1,126.1089,0_107,42,0.1,128.1388,0_108,42,0.1,130.0887,0_109,42,0.1000001,132.0518,0_110,42,0.1,134.0051,0_111,42,0.1,136.0128,0_112,42,0.1,138.066,0_113,42,0.1,140.0123,0_114,42,0.1,142.1242,0_115,42,0.1,144.0695,0_116,42,0.1,146.1152,0_117,42,0.1000001,148.0664,0_118,42,0.1,150.1012,0_119,42,0.1,152.032,0_120,42,0.1,154.0787,0_121,42,0.1,156.0278,0_122,42,0.1,158.0677,0_123,41.28269,0.1,159,3_124,39.25692,0.1000001,159,3_125,37.22325,0.1,159,3_126,35.19372,0.1,159,3_127,33.22911,0.1,159,3_128,31.25883,0.208681,159,3_129,29.2502,1.342003,159,3_130,27.29219,1.951747,159,3_131,25.18644,1.808282,159,3_132,23.29716,1.021112,159,3_133,21.28365,0.1,159,3_134,19.15911,0.1,159,3_135,17.20421,0.1,159,3_136,15.19847,0.1,159,3_137,14,0.1000001,159.8723,0_138,14,0.1,161.8905,0_139,14,0.1,163.8638,0_140,14,0.1,165.8952,0_141,14,0.1,167.9185,0_142,14,0.1,169.9599,0_143,14,0.1,171.8415,0_144,14,0.1,173.8666,0_145,14,0.1,175.8102,0_146,14,0.1,177.9323,0_147,14,0.1000001,179.9662,0_148,14,0.8829929,181.8022,0_149,14,1.783857,183.8531,0_150,14,1.979483,185.803,0_151,14,1.379279,187.9245,0_152,14,0.2892201,189.8848,0_153,14,0.1,191.8276,0_154,14,0.1,193.8532,0_155,14,0.1,195.8212,0_156,14,0.1,197.8359,0_157,14,0.1,199.8573,0_158,15.25377,0.1,201,1_159,17.37461,0.1,201,1_160,19.23554,0.1,201,1_161,21.27834,0.3838508,201,1_162,23.32065,1.482237,201,1_163,25.28202,1.985646,201,1_164,27.31081,1.738136,201,1_165,29.33349,0.8116329,201,1_166,31.27883,0.1000001,201,1_167,33.29889,0.1,201,1_168,35.26767,0.1,201,1_169,37.28144,0.1,201,1_170,39.31012,0.1,201,1_171,40,0.1,202.1498,0_172,40,0.1000001,204.1209,0_173,40,0.1,206.1247,0_174,40,0.1,208.087,0_175,40,0.1,210.0523,0_176,40,0.1,212.172,0_177,40,0.1,214.05,0_178,40,0.1,216.0572,0_179,40,0.1,218.189,0_180,40,0.1,220.0644,0_181,40,0.1,222.0699,0_182,40,0.6437789,224.1536,0_183,40,1.634291,226.1549,0_184,40,1.999961,228.0906,0_185,40,1.583597,230.2019,0_186,40,0.6322836,232.0866,0_187,40,0.1,234.1454,0_188,40,0.1,236.0767,0_189,40,0.1,238.1578,0
}
